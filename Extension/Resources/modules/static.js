/**
 * modules/static.js — 静的定数・設定値
 *
 * Rajiko 設計参照:
 *   - RULE_IDS: ルール ID を用途別に定数管理（衝突回避）
 *   - APP_KEY_MAP: アプリ別認証キー
 *   - GPS_COORDINATES: 都道府県ごとの緯度経度（Auth2 で送信）
 *   - VERSION_MAP: Android 端末情報偽装用テーブル
 *   - PLAYER_RULE_TEMPLATE: HLS セグメント URL マッチパターン
 */

// ─── declarativeNetRequest ルール ID ──────────────────────────────────────────
// 用途ごとに ID レンジを分離して管理しやすくする
export const RULE_IDS = {
  // Radiko 認証リクエストへのヘッダー注入
  AUTH1:       5002,
  AUTH2:       5003,
  AUTH_FETCH:  5004,

  // HLS プレイヤー（ストリーム）へのトークン注入
  // 局ごとに ID を割り当てる場合は RADIO_BASE + index を使用
  RADIO_BASE:  20000,
};

// ─── 認証キー ─────────────────────────────────────────────────────────────────
// Radiko アプリ別の固定鍵（公知の値）
export const APP_KEY_MAP = {
  pc_html5: "bcd151073c03b352e1ef2fd66c32209da9ca0afa",
  // Android アプリキーが判明した場合はここに追加
};

// ─── GPS 座標（都道府県） ────────────────────────────────────────────────────
// Auth2 の X-Radiko-Location ヘッダーで送信する緯度経度
// フォーマット: [latitude, longitude]
export const GPS_COORDINATES = {
  JP01: [43.064615, 141.346807],  // 北海道
  JP02: [40.824622, 140.740059],  // 青森
  JP03: [39.703619, 141.152684],  // 岩手
  JP04: [38.268839, 140.872103],  // 宮城
  JP05: [39.718614, 140.102364],  // 秋田
  JP06: [38.240437, 140.363592],  // 山形
  JP07: [37.750299, 140.467522],  // 福島
  JP08: [36.341811, 140.446793],  // 茨城
  JP09: [36.565725, 139.883565],  // 栃木
  JP10: [36.390668, 139.060406],  // 群馬
  JP11: [35.857428, 139.648933],  // 埼玉
  JP12: [35.605058, 140.123308],  // 千葉
  JP13: [35.689488, 139.691706],  // 東京
  JP14: [35.447507, 139.642345],  // 神奈川
  JP15: [37.902552, 139.023095],  // 新潟
  JP16: [36.695291, 137.211338],  // 富山
  JP17: [36.594682, 136.625573],  // 石川
  JP18: [36.065178, 136.221527],  // 福井
  JP19: [35.664158, 138.568449],  // 山梨
  JP20: [36.651299, 138.180956],  // 長野
  JP21: [35.391227, 136.722291],  // 岐阜
  JP22: [34.97712,  138.383084],  // 静岡
  JP23: [35.180188, 136.906565],  // 愛知
  JP24: [34.730283, 136.508588],  // 三重
  JP25: [35.004531, 135.868591],  // 滋賀
  JP26: [35.021247, 135.755597],  // 京都
  JP27: [34.686316, 135.519711],  // 大阪
  JP28: [34.691269, 135.183071],  // 兵庫
  JP29: [34.685334, 135.832742],  // 奈良
  JP30: [34.226034, 135.167506],  // 和歌山
  JP31: [35.503891, 134.237736],  // 鳥取
  JP32: [35.472306, 133.050499],  // 島根
  JP33: [34.661751, 133.934406],  // 岡山
  JP34: [34.396601, 132.459595],  // 広島
  JP35: [34.185956, 131.470649],  // 山口
  JP36: [34.065718, 134.559296],  // 徳島
  JP37: [34.340149, 134.043444],  // 香川
  JP38: [33.841624, 132.765681],  // 愛媛
  JP39: [33.559706, 133.531080],  // 高知
  JP40: [33.606767, 130.418314],  // 福岡
  JP41: [33.249442, 130.299794],  // 佐賀
  JP42: [32.744839, 129.873756],  // 長崎
  JP43: [32.789827, 130.741667],  // 熊本
  JP44: [33.238172, 131.612619],  // 大分
  JP45: [31.911090, 131.423855],  // 宮崎
  JP46: [31.560148, 130.557981],  // 鹿児島
  JP47: [26.212401, 127.680932],  // 沖縄
};

// エリア ID → 都道府県名（表示用）
export const AREA_NAMES = {
  JP01: "北海道", JP02: "青森", JP03: "岩手", JP04: "宮城", JP05: "秋田",
  JP06: "山形",   JP07: "福島", JP08: "茨城", JP09: "栃木", JP10: "群馬",
  JP11: "埼玉",   JP12: "千葉", JP13: "東京", JP14: "神奈川",JP15: "新潟",
  JP16: "富山",   JP17: "石川", JP18: "福井", JP19: "山梨", JP20: "長野",
  JP21: "岐阜",   JP22: "静岡", JP23: "愛知", JP24: "三重", JP25: "滋賀",
  JP26: "京都",   JP27: "大阪", JP28: "兵庫", JP29: "奈良", JP30: "和歌山",
  JP31: "鳥取",   JP32: "島根", JP33: "岡山", JP34: "広島", JP35: "山口",
  JP36: "徳島",   JP37: "香川", JP38: "愛媛", JP39: "高知", JP40: "福岡",
  JP41: "佐賀",   JP42: "長崎", JP43: "熊本", JP44: "大分", JP45: "宮崎",
  JP46: "鹿児島", JP47: "沖縄",
};

// ─── Android 端末情報テーブル ─────────────────────────────────────────────────
// Auth リクエストで偽装する Android バージョン / ビルド情報
// Rajiko の VERSION_MAP を参考に主要端末を抜粋
export const VERSION_MAP = [
  { androidVersion: "14.0.0", sdkVersion: "34", buildNumber: "UP1A.231005.007" },
  { androidVersion: "14.0.0", sdkVersion: "34", buildNumber: "AP1A.240405.002" },
  { androidVersion: "13.0.0", sdkVersion: "33", buildNumber: "TQ3A.230901.001" },
  { androidVersion: "13.0.0", sdkVersion: "33", buildNumber: "TP1A.220624.014" },
  { androidVersion: "12.0.0", sdkVersion: "31", buildNumber: "SQ3A.220705.004" },
  { androidVersion: "12.0.0", sdkVersion: "31", buildNumber: "SP1A.210812.016" },
  { androidVersion: "11.0.0", sdkVersion: "30", buildNumber: "RP1A.200720.009" },
];

// Radiko Android アプリのバージョン
export const RADIKO_APP_VERSION = "7.5.0";

// ─── HLS プレイヤー URL パターン ─────────────────────────────────────────────
// declarativeNetRequest の urlFilter に使用する HLS ストリーム URL パターン
// トークン注入対象。|| は eTLD+1 アンカー。
export const PLAYER_URL_FILTERS = [
  "||radiko.jp/v2/api/ts/",           // タイムフリー HLS
  "||radiko.jp/v2/api/stream/",       // ライブ HLS
  "||smartstream.ne.jp/",             // CDN (スマートストリーム)
  "||radiko-cf.com/",                 // CDN (CloudFront)
];

// ─── 不要ヘッダーリスト ───────────────────────────────────────────────────────
// declarativeNetRequest の removeHeaders で削除するヘッダー
// (ブラウザが自動付与するがサーバー側で拒否される可能性があるもの)
export const IGNORELIST = [
  "accept-language",
  "cookie",
  "referer",
  "x-radiko-user",
  "x-radiko-device",
];

// ─── タイムフリー取得設定 ─────────────────────────────────────────────────────
// 1 回の m3u8 フェッチで取得する時間幅（秒）
export const FIXED_SEEK_SEC = 300;

// セグメントの並列フェッチ数
export const MAX_WORKERS = 6;
